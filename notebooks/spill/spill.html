

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Global Port Spillover Estimator &#8212; Red Sea Monitoring</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/spill/spill';</script>
    <link rel="canonical" href="http://datapartnership.org/red-sea-monitoring/notebooks/spill/spill.html" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Shipping and Conflict" href="../indicators/conflict-and-trade.html" />
    <link rel="prev" title="Port Disruption Spillover Estimates" href="spillover-README.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Mar 18, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo-lab.png" class="logo__image only-light" alt="Red Sea Monitoring - Home"/>
    <script>document.write(`<img src="../../_static/logo-lab.png" class="logo__image only-dark" alt="Red Sea Monitoring - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Data Goods</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/1-intro-to-data-goods.html">Introduction to Data Goods</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/2-data.html">Data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reusable Data Products</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../README.html">Reusable Data Science Products</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chokepoints/README.html">Maritime Choke Point Trends Monitor</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chokepoints/red-sea-chokepoints.html">Choke Point Notebook</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ports/README.html">Port Call Trends Monitor</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ports/red-sea-ports.html">Ports Notebook</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../conflict/acled.html">Conflict Location and Trends Monitor</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="spillover-README.html">Port Disruption Spillover Estimates</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Global Port Spillover Estimator</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Insights and Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../indicators/conflict-and-trade.html">Shipping and Conflict</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Acknowledgements</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/6-team.html">Data Goods Team and Acknowedgements</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Additional Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://datapartnership.org">Development Data Partnership</a></li>
<li class="toctree-l1"><a class="reference external" href="https://wbdatalab.org">World Bank Data Lab</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.worldbank.org/en/about/unit/unit-dec">World Bank DEC</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.worldbank.org/en/research/dime">World Bank DIME</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/datapartnership/red-sea-monitoring" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/datapartnership/red-sea-monitoring/edit/main/notebooks/spill/spill.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/datapartnership/red-sea-monitoring/issues/new?title=Issue%20on%20page%20%2Fnotebooks/spill/spill.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/spill/spill.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Global Port Spillover Estimator</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">Methodology</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import Libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-i-estimating-at-risk-capacity-of-a-port-disruption-metric-tons-by-country">Part I: Estimating At-Risk Capacity of a Port Disruption (Metric Tons) by Country</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#read-in-downladed-dataset-and-select-country-of-interest">Read in Downladed Dataset and Select Country of Interest</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-data-for-top-ten-impacted-countries-summation-of-all-port-data-for-each-country">Filter Data for Top Ten Impacted Countries (Summation of All Port Data for Each Country)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-bar-chart">Generate Bar Chart</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregated-by-country-export-capacity-at-risk-during-a-90-day-disruption-of-any-port-in-a-selected-country-metric-tons">Aggregated by Country, Export Capacity at Risk during a 90-Day Disruption of Any Port in a Selected Country (Metric Tons)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-ii-estimating-aggregated-at-risk-export-value-by-country-from-any-port-disruption-in-a-selected-country-usd">Part II: Estimating Aggregated At-Risk Export Value by Country from Any Port Disruption in a Selected Country (USD)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Read in Downladed Dataset and Select Country of Interest</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-data-for-top-ten-impacted-countries-summation-of-all-ports-data-for-each-country">Filter Data for Top Ten Impacted Countries (Summation of All Ports Data for Each Country)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Generate Bar Chart</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregated-by-country-export-value-at-risk-during-a-90-day-disruption-of-any-port-in-a-selected-country-usd">Aggregated by Country, Export Value at Risk during a 90-Day Disruption of Any Port in a Selected Country (USD)</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#identify-top-ten-countries-in-terms-of-impacted-percentage-of-total-exports-by-a-port-disruption">Identify Top Ten Countries in Terms of Impacted Percentage of Total Exports by a Port Disruption</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Generate Bar Chart</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregated-by-country-export-value-at-risk-due-to-disruption-of-any-port-in-a-selected-country-percent-of-total-export-value">Aggregated by Country, Export Value at Risk due to Disruption of Any Port in a Selected Country (Percent of Total Export Value)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="global-port-spillover-estimator">
<h1>Global Port Spillover Estimator<a class="headerlink" href="#global-port-spillover-estimator" title="Permalink to this heading">#</a></h1>
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Permalink to this heading">#</a></h2>
<p>This analysis uses data from the <a class="reference external" href="https://portwatch.imf.org/">IMF Portwatch Portal</a>:</p>
<ul class="simple">
<li><p>Spillover similulator-generated data for at-risk capacity (metric tons) dataset:<a class="reference external" href="https://portwatch-imf-dataviz.hub.arcgis.com/datasets/568ee4b957b84481b2af1592f9ad22dd/about">Portwatch Spillover At-Risk Capacity Simulator Data</a>.</p></li>
<li><p>Spillover simulator-generated data for at-risk-value (USD) dataset: <a class="reference external" href="https://portwatch.imf.org/datasets/4257aafcbff6453688ee72be7207bd37/about">Portwatch Spillover At-Risk Value Simulator Data</a></p></li>
</ul>
<p>The Portwatch data draw upon a port-level geospatial layer describes the network of port-to-port connections given vessels movements between two respective ports. The network is based on a satellite-derived dataset of vessel movements of around 10,000 vessels between 2019 and 2020, from which a port-to-port transport network was constructed.</p>
<p>The spillover simulator estimates the amount of maritime capacity being at-risk of facing delays or disruptions due to port disruptions that affect outgoing vessel movements. These estimates are based on data as of <em>November 12, 2023</em>. The model assumes a linear relationship between the number of days of disruption and the impacts, measured in terms of lost metric tons (capacity) or USD (value)</p>
<p>Reference paper: <a class="reference external" href="https://doi.org/10.1038/s41558-023-01754-w">Verschuur, J., Koks, E.E. &amp; Hall, J.W. Systemic risks from climate-related disruptions at ports. Nat. Clim. Chang. 13, 804–806 (2023).</a></p>
</section>
<section id="methodology">
<h2>Methodology<a class="headerlink" href="#methodology" title="Permalink to this heading">#</a></h2>
<section id="import-libraries">
<h3>Import Libraries<a class="headerlink" href="#import-libraries" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="part-i-estimating-at-risk-capacity-of-a-port-disruption-metric-tons-by-country">
<h3>Part I: Estimating At-Risk Capacity of a Port Disruption (Metric Tons) by Country<a class="headerlink" href="#part-i-estimating-at-risk-capacity-of-a-port-disruption-metric-tons-by-country" title="Permalink to this heading">#</a></h3>
<section id="read-in-downladed-dataset-and-select-country-of-interest">
<h4>Read in Downladed Dataset and Select Country of Interest<a class="headerlink" href="#read-in-downladed-dataset-and-select-country-of-interest" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the data from the downloaded file into a DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/2023-11-12-spill-data.csv&#39;</span><span class="p">)</span>

<span class="c1"># Filter data to only select rows where &quot;to_country&quot; = &quot;Yemen&quot; (for example)</span>
<span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;to_country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Yemen&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="filter-data-for-top-ten-impacted-countries-summation-of-all-port-data-for-each-country">
<h4>Filter Data for Top Ten Impacted Countries (Summation of All Port Data for Each Country)<a class="headerlink" href="#filter-data-for-top-ten-impacted-countries-summation-of-all-port-data-for-each-country" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identify the top ten &quot;from_country&quot; with greatest &quot;daily_capacity_at_risk&quot;</span>
<span class="n">top_ten_countries</span> <span class="o">=</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;from_country&#39;</span><span class="p">)[</span><span class="s1">&#39;daily_capacity_at_risk&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Create a new table with 90-day indicator (using standard numbers in lieu of scientific notation)</span>
<span class="n">new_table</span> <span class="o">=</span> <span class="n">top_ten_countries</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">new_table</span><span class="p">[</span><span class="s1">&#39;daily_capacity_at_risk_90_days_disruption&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">new_table</span><span class="p">[</span><span class="s1">&#39;daily_capacity_at_risk&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">90</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="generate-bar-chart">
<h4>Generate Bar Chart<a class="headerlink" href="#generate-bar-chart" title="Permalink to this heading">#</a></h4>
<section id="aggregated-by-country-export-capacity-at-risk-during-a-90-day-disruption-of-any-port-in-a-selected-country-metric-tons">
<h5>Aggregated by Country, Export Capacity at Risk during a 90-Day Disruption of Any Port in a Selected Country (Metric Tons)<a class="headerlink" href="#aggregated-by-country-export-capacity-at-risk-during-a-90-day-disruption-of-any-port-in-a-selected-country-metric-tons" title="Permalink to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sort &#39;daily_capacity_at_risk_90_days_disruption&#39; in descending order</span>
<span class="n">sorted_table</span> <span class="o">=</span> <span class="n">new_table</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">sorted_table</span><span class="p">[</span><span class="s1">&#39;daily_capacity_at_risk_90_days_disruption&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sorted_table</span><span class="p">[</span><span class="s1">&#39;daily_capacity_at_risk_90_days_disruption&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">sorted_table</span> <span class="o">=</span> <span class="n">sorted_table</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;daily_capacity_at_risk_90_days_disruption&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Create vertical bar chart with adjusted y-axis labels (without scientific notation)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">sorted_table</span><span class="p">[</span><span class="s1">&#39;from_country&#39;</span><span class="p">],</span> <span class="n">sorted_table</span><span class="p">[</span><span class="s1">&#39;daily_capacity_at_risk_90_days_disruption&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Simulated Capacity at Risk from 90 Days Disruption at all Yemen Ports (metric tons)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;From Country&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Estimated Capacity at Risk in Top Ten Countries Most Impacted by 90-Day Disruption in Yemen Ports (metric tons)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

<span class="c1"># Adjust y-axis labels to display standard numbers</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:,}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))))</span>

<span class="c1"># Add gray grid lines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;images/capacity.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Show accompanying table for clarity</span>
<span class="n">sorted_table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/995b35897e90afd21754bdbc578c27cfe9859594f5ea2681b5a422cd5bb3dd79.png" src="../../_images/995b35897e90afd21754bdbc578c27cfe9859594f5ea2681b5a422cd5bb3dd79.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>from_country</th>
      <th>daily_capacity_at_risk</th>
      <th>daily_capacity_at_risk_90_days_disruption</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Saudi Arabia</td>
      <td>12643.487558</td>
      <td>1137914</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Djibouti</td>
      <td>11860.796300</td>
      <td>1067472</td>
    </tr>
    <tr>
      <th>2</th>
      <td>United Arab Emirates</td>
      <td>3855.990247</td>
      <td>347039</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Türkiye</td>
      <td>3282.348785</td>
      <td>295411</td>
    </tr>
    <tr>
      <th>4</th>
      <td>South Africa</td>
      <td>1509.575073</td>
      <td>135862</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Russian Federation</td>
      <td>1303.949299</td>
      <td>117355</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Oman</td>
      <td>1076.202858</td>
      <td>96858</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Ukraine</td>
      <td>998.247991</td>
      <td>89842</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Egypt</td>
      <td>837.215334</td>
      <td>75349</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Malaysia</td>
      <td>730.501202</td>
      <td>65745</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>
<section id="part-ii-estimating-aggregated-at-risk-export-value-by-country-from-any-port-disruption-in-a-selected-country-usd">
<h3>Part II: Estimating Aggregated At-Risk Export Value by Country from Any Port Disruption in a Selected Country (USD)<a class="headerlink" href="#part-ii-estimating-aggregated-at-risk-export-value-by-country-from-any-port-disruption-in-a-selected-country-usd" title="Permalink to this heading">#</a></h3>
<section id="id1">
<h4>Read in Downladed Dataset and Select Country of Interest<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the data from the downloaded file into a DataFrame</span>
<span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/2023-11-12-spill-country-data.csv&#39;</span><span class="p">)</span>

<span class="c1"># Filter data to only select rows where &quot;to_country&quot; = &quot;Yemen&quot; (for example)</span>
<span class="n">country_data</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;to_country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Yemen&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="filter-data-for-top-ten-impacted-countries-summation-of-all-ports-data-for-each-country">
<h4>Filter Data for Top Ten Impacted Countries (Summation of All Ports Data for Each Country)<a class="headerlink" href="#filter-data-for-top-ten-impacted-countries-summation-of-all-ports-data-for-each-country" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, filter the DataFrame to include only the rows where &#39;industry&#39; == &#39;Total&#39;</span>
<span class="n">total_industry_data</span> <span class="o">=</span> <span class="n">country_data</span><span class="p">[</span><span class="n">country_data</span><span class="p">[</span><span class="s1">&#39;industry&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Total&#39;</span><span class="p">]</span>

<span class="c1"># Group and aggregate on the filtered DataFrame</span>
<span class="n">grouped_data</span> <span class="o">=</span> <span class="n">total_industry_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;from_country&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">daily_export_value_at_risk</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;daily_export_value_at_risk&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">),</span>
    <span class="n">daily_import_value_at_risk</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;daily_import_value_at_risk&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Identify the top ten countries with the greatest daily_export_value_at_risk</span>
<span class="n">top_ten_exporters</span> <span class="o">=</span> <span class="n">grouped_data</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;daily_export_value_at_risk&#39;</span><span class="p">)</span>

<span class="c1"># Create a new table for these top ten countries, including a new column that multiplies the export value by 90 days (or other time period -- the relationship is linear)</span>
<span class="n">top_ten_exporters</span><span class="p">[</span><span class="s1">&#39;at_risk_daily_export_value_90x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_ten_exporters</span><span class="p">[</span><span class="s1">&#39;daily_export_value_at_risk&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">90</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h4>Generate Bar Chart<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h4>
<section id="aggregated-by-country-export-value-at-risk-during-a-90-day-disruption-of-any-port-in-a-selected-country-usd">
<h5>Aggregated by Country, Export Value at Risk during a 90-Day Disruption of Any Port in a Selected Country (USD)<a class="headerlink" href="#aggregated-by-country-export-value-at-risk-during-a-90-day-disruption-of-any-port-in-a-selected-country-usd" title="Permalink to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create bar chart with y-axis showing &quot;millions&quot; and gray grid lines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">top_ten_exporters</span><span class="p">[</span><span class="s1">&#39;from_country&#39;</span><span class="p">],</span> <span class="n">top_ten_exporters</span><span class="p">[</span><span class="s1">&#39;at_risk_daily_export_value_90x&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top Countries by At-Risk Export Value with 90-Day Port Disruption in Yemen&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;At-Risk Export Value with 90-Day Port Disruption in Yemen (Millions of US Dollars&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Adjust the y-axis labels to reflect the new scale in millions</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

<span class="c1"># Display the adjusted plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;images/value.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Show the new table for top ten countries</span>
<span class="n">top_ten_exporters</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9172bf7ef95b04abd2f5b6e1a967439859a79436eee174ebc559be182067ba58.png" src="../../_images/9172bf7ef95b04abd2f5b6e1a967439859a79436eee174ebc559be182067ba58.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>from_country</th>
      <th>daily_export_value_at_risk</th>
      <th>daily_import_value_at_risk</th>
      <th>at_risk_daily_export_value_90x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>73</th>
      <td>Saudi Arabia</td>
      <td>1.392650e+06</td>
      <td>1.382254e+07</td>
      <td>1.253385e+08</td>
    </tr>
    <tr>
      <th>13</th>
      <td>China</td>
      <td>1.073514e+06</td>
      <td>6.136940e+06</td>
      <td>9.661629e+07</td>
    </tr>
    <tr>
      <th>100</th>
      <td>Yemen</td>
      <td>3.543018e+05</td>
      <td>1.353540e+07</td>
      <td>3.188716e+07</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Singapore</td>
      <td>1.765200e+05</td>
      <td>4.802792e+06</td>
      <td>1.588680e+07</td>
    </tr>
    <tr>
      <th>52</th>
      <td>Malaysia</td>
      <td>1.427114e+05</td>
      <td>1.464506e+06</td>
      <td>1.284402e+07</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Oman</td>
      <td>1.243433e+05</td>
      <td>1.370501e+06</td>
      <td>1.119089e+07</td>
    </tr>
    <tr>
      <th>34</th>
      <td>India</td>
      <td>9.906518e+04</td>
      <td>1.832184e+06</td>
      <td>8.915866e+06</td>
    </tr>
    <tr>
      <th>94</th>
      <td>United Arab Emirates</td>
      <td>8.772177e+04</td>
      <td>1.964594e+06</td>
      <td>7.894959e+06</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Kuwait</td>
      <td>6.466021e+04</td>
      <td>4.853408e+04</td>
      <td>5.819419e+06</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Thailand</td>
      <td>4.703336e+04</td>
      <td>5.448601e+05</td>
      <td>4.233002e+06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="identify-top-ten-countries-in-terms-of-impacted-percentage-of-total-exports-by-a-port-disruption">
<h4>Identify Top Ten Countries in Terms of Impacted Percentage of Total Exports by a Port Disruption<a class="headerlink" href="#identify-top-ten-countries-in-terms-of-impacted-percentage-of-total-exports-by-a-port-disruption" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate total export value for each country to all destinations</span>
<span class="n">total_export_to_all_countries</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">[</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;industry&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;from_country&#39;</span><span class="p">)[</span><span class="s1">&#39;daily_export_value_at_risk&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">total_export_to_all_countries</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;daily_export_value_at_risk&#39;</span><span class="p">:</span> <span class="s1">&#39;total_export_value_to_all&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Merge this with the top_ten_exporters DataFrame</span>
<span class="n">top_ten_exporters_with_total</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">top_ten_exporters</span><span class="p">,</span> <span class="n">total_export_to_all_countries</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;from_country&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Calculate percent of total export value to selected country out of total export value to all countries</span>
<span class="n">top_ten_exporters_with_total</span><span class="p">[</span><span class="s1">&#39;portion_of_total_export_to_Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">top_ten_exporters_with_total</span><span class="p">[</span><span class="s1">&#39;daily_export_value_at_risk&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">top_ten_exporters_with_total</span><span class="p">[</span><span class="s1">&#39;total_export_value_to_all&#39;</span><span class="p">])</span>

<span class="c1"># Sort the DataFrame by &#39;portion_of_total_export_to_Country&#39; in descending order</span>
<span class="n">sorted_by_portion_to_yemen</span> <span class="o">=</span> <span class="n">top_ten_exporters_with_total</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;portion_of_total_export_to_Country&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Select the top ten countries based on the largest &#39;portion_of_total_export_to_Country&#39;</span>
<span class="n">top_ten_countries_by_portion_to_country</span> <span class="o">=</span> <span class="n">sorted_by_portion_to_yemen</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Now, &#39;top_ten_countries_by_portion_to_yemen&#39; contains the top ten countries in terms of portion of total export to Yemen.</span>
<span class="n">top_ten_countries_by_portion_to_country</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>from_country</th>
      <th>daily_export_value_at_risk</th>
      <th>daily_import_value_at_risk</th>
      <th>at_risk_daily_export_value_90x</th>
      <th>total_export_value_to_all</th>
      <th>portion_of_total_export_to_Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Yemen</td>
      <td>3.543018e+05</td>
      <td>1.353540e+07</td>
      <td>3.188716e+07</td>
      <td>3.387392e+07</td>
      <td>0.010459</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Saudi Arabia</td>
      <td>1.392650e+06</td>
      <td>1.382254e+07</td>
      <td>1.253385e+08</td>
      <td>1.310762e+09</td>
      <td>0.001062</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Oman</td>
      <td>1.243433e+05</td>
      <td>1.370501e+06</td>
      <td>1.119089e+07</td>
      <td>1.819159e+08</td>
      <td>0.000684</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Kuwait</td>
      <td>6.466021e+04</td>
      <td>4.853408e+04</td>
      <td>5.819419e+06</td>
      <td>1.235327e+08</td>
      <td>0.000523</td>
    </tr>
    <tr>
      <th>1</th>
      <td>China</td>
      <td>1.073514e+06</td>
      <td>6.136940e+06</td>
      <td>9.661629e+07</td>
      <td>9.855455e+09</td>
      <td>0.000109</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Malaysia</td>
      <td>1.427114e+05</td>
      <td>1.464506e+06</td>
      <td>1.284402e+07</td>
      <td>1.569800e+09</td>
      <td>0.000091</td>
    </tr>
    <tr>
      <th>6</th>
      <td>India</td>
      <td>9.906518e+04</td>
      <td>1.832184e+06</td>
      <td>8.915866e+06</td>
      <td>1.380379e+09</td>
      <td>0.000072</td>
    </tr>
    <tr>
      <th>7</th>
      <td>United Arab Emirates</td>
      <td>8.772177e+04</td>
      <td>1.964594e+06</td>
      <td>7.894959e+06</td>
      <td>1.328998e+09</td>
      <td>0.000066</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Thailand</td>
      <td>4.703336e+04</td>
      <td>5.448601e+05</td>
      <td>4.233002e+06</td>
      <td>8.547186e+08</td>
      <td>0.000055</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Singapore</td>
      <td>1.765200e+05</td>
      <td>4.802792e+06</td>
      <td>1.588680e+07</td>
      <td>4.315688e+09</td>
      <td>0.000041</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id3">
<h4>Generate Bar Chart<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h4>
<section id="aggregated-by-country-export-value-at-risk-due-to-disruption-of-any-port-in-a-selected-country-percent-of-total-export-value">
<h5>Aggregated by Country, Export Value at Risk due to Disruption of Any Port in a Selected Country (Percent of Total Export Value)<a class="headerlink" href="#aggregated-by-country-export-value-at-risk-due-to-disruption-of-any-port-in-a-selected-country-percent-of-total-export-value" title="Permalink to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">PercentFormatter</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">top_ten_countries_by_portion_to_country</span><span class="p">[</span><span class="s1">&#39;from_country&#39;</span><span class="p">],</span> <span class="n">top_ten_countries_by_portion_to_country</span><span class="p">[</span><span class="s1">&#39;portion_of_total_export_to_Country&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Top Countries by At-Risk Export Value with a Port Disruption in Yemen, as Percentage of Total Export Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;At-Risk Export Value with a Port Disruption in Yemen (as percentage of total exports)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Adjust the y-axis labels to reflect percentages with 3 decimal places</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">PercentFormatter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># Display the adjusted plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;images/value-percent.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5f8807926cc1b6418a3acd20ce17e89ee42993fdca8c97dfdc1741e778dc7e25.png" src="../../_images/5f8807926cc1b6418a3acd20ce17e89ee42993fdca8c97dfdc1741e778dc7e25.png" />
</div>
</div>
</section>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/spill"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="spillover-README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Port Disruption Spillover Estimates</p>
      </div>
    </a>
    <a class="right-next"
       href="../indicators/conflict-and-trade.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Shipping and Conflict</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">Methodology</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import Libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-i-estimating-at-risk-capacity-of-a-port-disruption-metric-tons-by-country">Part I: Estimating At-Risk Capacity of a Port Disruption (Metric Tons) by Country</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#read-in-downladed-dataset-and-select-country-of-interest">Read in Downladed Dataset and Select Country of Interest</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-data-for-top-ten-impacted-countries-summation-of-all-port-data-for-each-country">Filter Data for Top Ten Impacted Countries (Summation of All Port Data for Each Country)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-bar-chart">Generate Bar Chart</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregated-by-country-export-capacity-at-risk-during-a-90-day-disruption-of-any-port-in-a-selected-country-metric-tons">Aggregated by Country, Export Capacity at Risk during a 90-Day Disruption of Any Port in a Selected Country (Metric Tons)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-ii-estimating-aggregated-at-risk-export-value-by-country-from-any-port-disruption-in-a-selected-country-usd">Part II: Estimating Aggregated At-Risk Export Value by Country from Any Port Disruption in a Selected Country (USD)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Read in Downladed Dataset and Select Country of Interest</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-data-for-top-ten-impacted-countries-summation-of-all-ports-data-for-each-country">Filter Data for Top Ten Impacted Countries (Summation of All Ports Data for Each Country)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Generate Bar Chart</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregated-by-country-export-value-at-risk-during-a-90-day-disruption-of-any-port-in-a-selected-country-usd">Aggregated by Country, Export Value at Risk during a 90-Day Disruption of Any Port in a Selected Country (USD)</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#identify-top-ten-countries-in-terms-of-impacted-percentage-of-total-exports-by-a-port-disruption">Identify Top Ten Countries in Terms of Impacted Percentage of Total Exports by a Port Disruption</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Generate Bar Chart</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregated-by-country-export-value-at-risk-due-to-disruption-of-any-port-in-a-selected-country-percent-of-total-export-value">Aggregated by Country, Export Value at Risk due to Disruption of Any Port in a Selected Country (Percent of Total Export Value)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Data Lab
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Mar 18, 2024.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div>
 Country borders or names do not necessarily reflect the World Bank Group’s official position. All maps are for illustrative purposes and do not imply the expression of any opinion on the part of the World Bank, concerning the legal status of any country or territory or concerning the delimitation of frontiers or boundaries
</div>
<div>
    <b>All content (unless otherwise specified) is subject to the <a href="https://www.mozilla.org/en-US/MPL">Mozilla Public License.</a></b>
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>